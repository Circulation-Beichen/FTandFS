# 傅里叶级数与傅里叶变换演示程序报告

## 实验目的

- 通过交互式GUI程序直观展示傅里叶级数和傅里叶变换之间的关系，帮助用户深入理解信号的频域分析
- 使用户能够自由输入各种函数并实时观察其傅里叶变换结果，增强对信号频谱特性的理解
- 通过预设常见信号（如δ函数、正弦函数、方波等）的变换结果，帮助用户建立时域-频域对应关系的直观认识
- 提供逆变换功能，让用户理解从频域到时域的转换过程，完整掌握信号的双域表示

## 实验原理

### 傅里叶级数

傅里叶级数是将周期信号分解为不同频率正弦波和余弦波的线性组合：

$$
f(t) = \frac{a_0}{2} + \sum_{n=1}^{\infty} [a_n \cos(n\omega_0 t) + b_n \sin(n\omega_0 t)]
$$

其中：

- $\omega_0 = \frac{2\pi}{T}$ 是基频，$T$ 是信号周期
- $a_n$ 和 $b_n$ 是傅里叶系数

### 傅里叶变换

傅里叶变换是傅里叶级数的推广，适用于非周期信号，将时域信号转换为频域表示：

$$
F(\omega) = \int_{-\infty}^{\infty} f(t) e^{-j\omega t} dt
$$

逆傅里叶变换：

$$
f(t) = \frac{1}{2\pi} \int_{-\infty}^{\infty} F(\omega) e^{j\omega t} d\omega
$$

### 常见函数的傅里叶变换对

1. **δ函数 (单位冲激函数)**

   - 时域: $\delta(t)$
   - 频域: $1$ (常数)
2. **常数函数**

   - 时域: $1$
   - 频域: $2\pi\delta(\omega)$
3. **正弦/余弦函数**

   - 时域: $\sin(\omega_0 t)$ 或 $\cos(\omega_0 t)$
   - 频域: 在 $\pm\omega_0$ 处的两个峰值
4. **高斯函数**

   - 时域: $e^{-at^2}$
   - 频域: $\sqrt{\frac{\pi}{a}}e^{-\frac{\omega^2}{4a}}$
5. **矩形脉冲/方波**

   - 时域: 矩形脉冲
   - 频域: $\text{sinc}$ 函数

### 离散傅里叶变换 (DFT)

在数字计算中，我们使用离散傅里叶变换 (DFT) 进行数值计算：

$$
X[k] = \sum_{n=0}^{N-1} x[n] e^{-j2\pi kn/N}
$$

逆离散傅里叶变换 (IDFT):

$$
x[n] = \frac{1}{N}\sum_{k=0}^{N-1} X[k] e^{j2\pi kn/N}
$$

实际计算中使用快速傅里叶变换 (FFT) 算法提高效率。

## 实验环境

- **编程语言**: Python 3.9+
- **依赖库**:
  - NumPy: 用于数值计算和数组操作
  - SciPy: 提供信号处理和傅里叶变换功能
  - Matplotlib: 用于数据可视化
  - Tkinter: 提供GUI界面
  - SymPy: 用于符号数学运算

## 实验步骤

### 傅里叶变换演示

1. **信号输入**:

   - 用户可以通过GUI界面输入任意函数表达式
   - 提供常用函数快捷选择（δ函数、正弦、余弦、指数、方波、三角波等）
   - 设置信号采样的参数（x轴范围、采样点数）
2. **傅里叶变换计算**:

   - 对输入信号进行采样，得到离散时域数据
   - 使用SciPy的FFT函数对时域信号进行变换
   - 对结果进行频谱移位，使零频率成分位于中心
3. **结果可视化**:

   - 绘制原始时域信号
   - 绘制变换后的频谱（振幅谱）
   - 直观对比时域和频域表示

### 逆傅里叶变换演示

1. **频域信号输入**:

   - 用户输入频域函数表达式
   - 设置频域采样参数
2. **逆傅里叶变换计算**:

   - 对频域信号进行采样
   - 使用SciPy的IFFT函数进行逆变换
   - 获得时域表示
3. **结果可视化**:

   - 绘制原始频域信号
   - 绘制逆变换后的时域信号

## 关键算法实现

1. **函数解析与计算**:

   ```python
   def parse_function(self, func_str, x):
       # 定义特殊函数
       def dirac(x):
           result = np.zeros_like(x)
           center_idx = np.argmin(np.abs(x))
           result[center_idx] = 1.0
           return result

       # 安全的函数求值
       safe_dict = {
           'sin': np.sin,
           'cos': np.cos,
           'exp': np.exp,
           'pi': np.pi,
           'dirac': dirac,
           'x': x
       }

       return eval(func_str, {"__builtins__": {}}, safe_dict)
   ```
2. **傅里叶变换计算**:

   ```python
   def compute_fourier_transform(self, f, x, is_inverse=False):
       # 计算采样间隔
       dx = x[1] - x[0]

       if not is_inverse:
           # 正向傅里叶变换
           F = fftshift(fft(f) * dx)
           freq = fftshift(fftfreq(len(x), dx))
           return freq, F
       else:
           # 逆傅里叶变换
           F = ifft(ifftshift(f)) * len(x) * dx
           return x, F
   ```

## 实验结果与分析

通过本程序，用户可以观察到以下关键现象:

1. **时域信号与频域表示的对应关系**:

   - 正弦波在频域中表现为两个对称的峰值点
   - 方波信号在频域中是sinc函数的形式，高频分量逐渐减小
   - 高斯脉冲在频域中仍然是高斯分布
2. **信号特性的直观理解**:

   - 信号中的高频成分对应于变化快速的部分
   - 信号中的低频成分对应于变化缓慢的部分
   - 狄拉克δ函数包含所有频率的成分，其频谱是常数
3. **逆变换验证**:

   - 通过对频域信号进行逆傅里叶变换，可以重建原始信号
   - 验证了傅里叶变换的可逆性

## 结论

本实验通过交互式的方式展示了傅里叶级数和傅里叶变换的基本原理及应用。通过GUI界面，用户可以直观地理解不同信号在时域和频域的表示方式，以及它们之间的转换关系。这种直观的体验有助于加深对信号处理基本概念的理解。

程序设计采用了模块化的结构，使用了Python的科学计算库，实现了高效的数值计算和图形化显示。通过交互式输入和实时显示，用户可以自由探索各种函数的傅里叶变换特性，增强学习效果。
